<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录界面</title>
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
    <style>
        .bo{
            text-align: center;
            align-content: center;
        }
        .field{
            width: 300px;
            height: 200px;
            margin: 200px auto;
        }
    </style>
    <script>
        let app_name = 'flask-hwq-debug'
    function login(){
        console.log(jQuery.ajax({}))
        console.log("login clicked")
        console.log($('#account').val())
        console.log($('#password').val())
        $.ajax({
            url: "./login",
            type: "post",
            async: true,
            dataType: "json",
            data: {
                account: $('#account').val(),
                password: $('#password').val()
            },
            success: function (data){
                console.log("data", data)
                let redirect_url = data['url']
                console.log(redirect_url)
                if (data.code === 0) {
                    localStorage.setItem('account', data['account'])
                } else {
                    alert(data.msg)
                }
                setTimeout(
                    function (){
                        window.location.href = `..${redirect_url}`
                    }, 1000
                );
            }
        });
    }

    function CAS() {
        window.location.href = `https://cas.qima-inc.com/public/oauth/authorize?name=${app_name}&qs=hwq`
    }
</script>
</head>
<body class="bo">
    <div>
    <fieldset class="field">
        <legend>登录框</legend>
        账号：<input type="text" size="20" id="account" required="true"/> <br />
        密码：<input type="password" size="20" id="password" required="true"/> <br /> <br />
        <input type="button" id="btn_login" text="登录" value="登录" onclick="login()"/>&nbsp;&nbsp;
        <input type="button" id="btn_cancel" text="登出" value="登出" onclick="logout()"/>&nbsp;&nbsp;
        <input type="button" id="btn_CAS" text="接入CAS" value="CAS" onclick="CAS()"/>
        <br /><br />
        <p style="font-size: 14px; padding: 10px; text-shadow: 2px 2px 2px #ff0000">
            POWERED BY: 黄伟强
        </p>
    </fieldset>
    </div>
</body>
</html>